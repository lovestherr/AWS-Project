org: estabraq
service: aws-project

provider:
  name: aws
  runtime: python3.9
  region: eu-west-1
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - "s3:*"
            - "cognito-idp:*"
            - "dynamodb:*"
          Resource: "*"

plugins: 
  - serverless-offline
  - serverless-plugin-include-dependencies
  - serverless-plugin-common-excludes

functions:
  create:
    handler: handler.create
    events:
      - http:
          path: courses
          method: post
          cors: true
  upload_file:
    handler: handler.create  # Since file upload is part of the create function
    events:
      - http:
          path: files/upload
          method: post
          cors: true
  get_item:
    handler: handler.get_item
    events:
      - http:
          path: courses/{CourseID}
          method: get
          cors: true
  list_items:
    handler: handler.list_items
    events:
      - http:
          path: courses
          method: get
          cors: true
  login:
    handler: handler.login
    events:
      - http:
          path: login
          method: post
          cors: true
  get_enrolledCourses:
    handler: handler.get_enrolledCourses
    events:
      - http:
          path: get_enrolledCourses
          method: get
          cors: true
  get_userDetails:
    handler: handler.get_user_details
    events:
      - http:
          path: get_userDetails
          method: get
          cors: true